{# Filters, submit, reset, and other action buttons #}
{% if form['#filters'] is not empty %}

  <div class="c-listing__search">
    {% if attribute(form, 'search-term') is defined %}
      {{ attribute(form, 'search-term') }}
    {% endif %}
  </div>

  <div class="c-listing__filters-dropdowns js-filter-dropdowns">
    <span class="c-listing__filters-title">{{ 'Filter:'|t }}</span>

    {% for key in form['#filters'] %}
      {% if attribute(form, key) is defined and key not in ['active_filters', 'search-term'] %}
        {{ attribute(form, key) }}
      {% endif %}
    {% endfor %}

    {% for key in form['#submit_buttons'] %}
      {% if attribute(form, key) is defined %}
        {{ attribute(form, key) }}
      {% endif %}
    {% endfor %}

    {# Active filters are configured using BEF #}
    {% if form.active_filters is not empty %}
      {{ attribute(form, 'active_filters') }}
      {{ attach_library('soapbox_filters/active-filters') }}
    {% endif %}
  </div>
{% endif %}

{# Sorters #}
{% if form['#sorters'] is not empty %}
  <div class="c-sorters">

    {% for key in form['#sorters'] %}
      {% if attribute(form, key) is defined %}
        {{ attribute(form, key) }}
      {% endif %}
    {% endfor %}

  </div>
{% endif %}

{# Output whatever is left unrendered such as hidden fields. #}
{% for key, value in form %}
  {% if
    not key starts with '#'
    and key not in form['#filters']
    and key not in form['#sorters']
    and key not in form['#submit_buttons'] %}
    {{ value }}
  {% endif %}
{% endfor %}
